{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
  <h3 class="text-center">{% block title %} MTurk > Qualification: {{ qual_id }} >All Hits {% endblock %}</h3>
  <div class="row">
    <div class="col-12">
      <p>Found {{ data['HITs'] | length }} HITs </p>
      <ul class="list-group">
        {% for HIT in data['HITs'] %}
        {% set hit_id = HIT['HITId'] %}
        <li id="{{hit_id}}" class="list-group-item">
          <span class="text-muted">{{ loop.index }} ― </span>

          <a href="/mturk/HIT/{{ hit_id }}">
            {{ hit_id }} | {{ HIT['Title'] }}</a>
          <details style="display: inline">
            <summary>⤵</summary>
            {% for key, value in HIT.items() %}
            <ul>
              <li><b>{{key}}</b>: {{value}}</li>
            </ul>
            {% endfor %}
          </details>
          <button onclick="delete_hit('{{hit_id}}')">Delete</button>
        </li>
        {% endfor %}
        </li>
      </ul>
    </div>
  </div>
</div>
<script>
  function delete_hit(hit_id) {
    console.log('Going to delete HIT ' + hit_id)
    $.ajax({
      url: "/mturk/HIT/" + hit_id,
      type: 'DELETE',
      success: function(result) {
          console.log('Delete Success')
          console.log(result)
          $('#'+hit_id).hide()
      },
      error: function(result) {
        alert("Error while deleting the hit: " + hit_id )
        console.log('Error while deleting HIT')
        console.log(result)
      },
  });
  }
</script>
{% endblock %}